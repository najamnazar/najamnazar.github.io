## Quick orientation

This repository is a Jekyll-based personal/academic website using the Academic Pages template (Minimal Mistakes derivative). Key ideas an AI agent should know up front:

- The site is generated by Jekyll (GitHub Pages). Primary sources: markdown and YAML under the root, `_posts/`, `_pages/`, `_talks/`, `_publications/`, `_includes/`, `_layouts/`, `_sass/`, `assets/`.
- Content collections in `_config.yml`: `talks`, `publications`, `teaching`, `portfolio`. Posts live in `_posts/` and use the `single` layout by default.
- Ruby/Bundler manages Jekyll and plugins (see `Gemfile`). Node/npm is used for small frontend build steps (see `package.json`).

## Where to look (files & dirs that matter)

- `_config.yml` — canonical site configuration, collections, defaults, excluded files, plugins, markdown settings. Changing this requires restarting the Jekyll server.
- `Gemfile` — the Jekyll runtime and GitHub Pages gems. Run `bundle install` after edits.
- `package.json` — JS build/dev scripts: `npm run uglify`, `npm run watch:js`, `npm run build:js`.
- `_includes/`, `_layouts/`, `_sass/` — templates and styling. Alter templates here to change page structure.
- `assets/js/_main.js` (source), `assets/js/main.min.js` (generated). The repo excludes the `_main.js` source from the Jekyll build; minified `main.min.js` is the runtime file.
- `files/` — static files served directly at `/files/...`.

Examples to reference in code changes:
- For page templates: `_layouts/single.html` and `_includes/author-profile.html`.
- For collection defaults and permalinks: read the `collections` and `defaults` sections in `_config.yml`.

## Common developer workflows (commands)

- Install Ruby dependencies (use whenever `Gemfile` changes):
  - PowerShell: `bundle install`
  - Run Jekyll with bundle exec (recommended): `bundle exec jekyll serve -l -H localhost`
  - Build static HTML: `bundle exec jekyll build`

- Frontend JS tasks (optional):
  - Install node deps: `npm install`
  - Build JS (produces `assets/js/main.min.js`): `npm run build:js` or `npm run uglify`
  - Watch JS during development: `npm run watch:js`

Notes:
- `_config.yml` is not hot-reloaded; restart `jekyll serve` after edits to it.
- On Windows the Gemfile includes `wdm`; make sure a compatible Ruby + DevKit is installed before `bundle install`.

## Project-specific conventions and patterns

- Unminified JS lives in `assets/js/_main.js` and plugin files under `assets/js/plugins/`. The build step concatenates+minifies into `assets/js/main.min.js` (see `package.json`). Do not manually edit the generated `main.min.js` in source PRs — treat it as built artifact unless updating JS build logic.
- Content defaults: most content types default to `layout: single` and `author_profile: true` (see `defaults` in `_config.yml`). When creating new collection items, front matter only needs to include fields that differ from defaults.
- Collections publish to `/collection-name/` per `collections` config. Use their permalink patterns when linking.
- Static site generator rules: `_config.yml` `exclude:` lists files and directories Jekyll will not include (for example `node_modules`, `package.json`, `assets/js/_main.js`). If you need to include something, update `_config.yml` carefully.

## Integration points & external dependencies

- GitHub Pages via the `github-pages` gem in `Gemfile` — production site builds on GitHub. Keep versions compatible with GitHub Pages when changing gems.
- Optional JS dependencies are managed via `npm` (jquery + simple build tooling here).
- Notebooks & generators: `markdown_generator/` and `talkmap/` contain scripts/notebooks used to generate markdown from TSV sources — these are auxiliary tools, not part of the Jekyll runtime.

## Small concrete examples for AI edits

- To add a new talk: create `_talks/YYYY-MM-DD-title.md` with front matter `---\nlayout: talk\ntitle: "My talk"\n---` (the `talk` layout is used by default in `defaults`).
- To update the author block, edit `_includes/author-profile.html` and the `author:` fields in `_config.yml`.
- To tweak CSS variables, edit files under `_sass/` (e.g., `_variables.scss`) then rebuild the site.

## What to avoid or be careful about

- Don’t change `Gemfile` or `_config.yml` without running `bundle install` and restarting the dev server; edits may silently be ignored if the server isn’t restarted.
- Avoid editing generated/minified artifacts directly (e.g., `assets/js/main.min.js`) — edit the source and run the build script.
- The template carries many defaults; adding unnecessary front matter to new pages is redundant. Prefer minimal front matter that overrides defaults only when needed.

## Quick checklist for code changes

1. Update source files under `_layouts`, `_includes`, `_posts`, `_pages`, `_sass`, `assets/js/_main.js` as needed.
2. If JS changed: `npm install` (once) then `npm run build:js`.
3. If Gemfile or plugins changed: `bundle install` and restart Jekyll.
4. Build locally: `bundle exec jekyll serve -l -H localhost` and verify changes on `http://localhost:4000`.
5. Commit only source changes (templates, content, source JS/Sass). If you must include generated artifacts, note this in your PR description.

---

If any part is unclear or you'd like me to include additional examples (sample front matter for talks/publications, or a minimal PR template with the exact commands to run on Windows), tell me which area and I will iterate.
